{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/zacla/OneDrive/Documents/Web/420-4A5_Projet_ZacharyLabelle/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/zacla/OneDrive/Documents/Web/420-4A5_Projet_ZacharyLabelle/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/zacla/OneDrive/Documents/Web/420-4A5_Projet_ZacharyLabelle/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{useParams,useHistory}from'react-router-dom';import{useHttpClient}from\"../../shared/hooks/http-hook\";import ErrorModal from\"../../shared/components/UIElements/ErrorModal\";import Card from'../../shared/components/UIElements/Card';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Etudiant=function Etudiant(){var _useHttpClient=useHttpClient(),error=_useHttpClient.error,sendRequest=_useHttpClient.sendRequest,clearError=_useHttpClient.clearError;var _useState=useState(),_useState2=_slicedToArray(_useState,2),etudiant=_useState2[0],setEtudiant=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),ListeStages=_useState4[0],setListeStages=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),stageSelectionne=_useState6[0],setstageSelectionne=_useState6[1];var numAdmission=useParams().numAdmission;var history=useHistory();useEffect(function(){var recupererEtudiant=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var responseData1,responseData2;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return sendRequest(process.env.REACT_APP_BACKEND_URL+\"/etudiants/\".concat(numAdmission));case 3:responseData1=_context.sent;setEtudiant(responseData1.etudiant);console.log(responseData1.etudiant);_context.next=8;return sendRequest(process.env.REACT_APP_BACKEND_URL+\"/stages/stages\");case 8:responseData2=_context.sent;setListeStages(responseData2.stages);console.log(responseData2.stages);if(responseData2.stages.length>0){setstageSelectionne(responseData2.stages[0].nomEntreprise);}_context.next=16;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);case 16:case\"end\":return _context.stop();}},_callee,null,[[0,14]]);}));return function recupererEtudiant(){return _ref.apply(this,arguments);};}();recupererEtudiant();},[sendRequest,numAdmission]);var etudiantUpdateSubmitHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(event){var monStage;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:event.preventDefault();_context2.prev=1;console.log(stageSelectionne);monStage=ListeStages.find(function(stage){return stage.nomEntreprise===stageSelectionne;});console.log(monStage);_context2.next=7;return sendRequest(process.env.REACT_APP_BACKEND_URL+\"/etudiants/\".concat(numAdmission),'PATCH',JSON.stringify({nom:etudiant.nom,courriel:etudiant.courriel,profil:etudiant.profil,stage:monStage}),{'Content-Type':'application/json'});case 7:alert(\"Affectation réussie!\");history.push('/etudiants');_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](1);alert(\"Erreur lors de l'affectation\");case 14:case\"end\":return _context2.stop();}},_callee2,null,[[1,11]]);}));return function etudiantUpdateSubmitHandler(_x){return _ref2.apply(this,arguments);};}();if((!ListeStages||!etudiant)&&!error){return/*#__PURE__*/_jsx(\"div\",{className:\"center\",children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Could not find place!\"})})});}return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(ErrorModal,{error:error,onClear:clearError}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:etudiantUpdateSubmitHandler,className:\"formulaire\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Affectation d'un stage pour l'\\xE9tudiant #\",etudiant.numAdmission,\".\"]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"S\\xE9lectionnez un stage\",/*#__PURE__*/_jsx(\"select\",{value:stageSelectionne,onChange:function onChange(event){setstageSelectionne(event.target.value);},children:ListeStages.map(function(stage,index){return/*#__PURE__*/_jsx(\"option\",{children:stage.nomEntreprise},index);})})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Affecter le stage \\xE0 l'\\xE9tudiant\"})]})]});};export default Etudiant;","map":{"version":3,"names":["React","useState","useEffect","useParams","useHistory","useHttpClient","ErrorModal","Card","Etudiant","error","sendRequest","clearError","etudiant","setEtudiant","ListeStages","setListeStages","stageSelectionne","setstageSelectionne","numAdmission","history","recupererEtudiant","process","env","REACT_APP_BACKEND_URL","responseData1","console","log","responseData2","stages","length","nomEntreprise","etudiantUpdateSubmitHandler","event","preventDefault","monStage","find","stage","JSON","stringify","nom","courriel","profil","alert","push","target","value","map","index"],"sources":["C:/Users/zacla/OneDrive/Documents/Web/420-4A5_Projet_ZacharyLabelle/frontend/src/etudiant/pages/Etudiant.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useParams, useHistory } from 'react-router-dom';\r\n\r\nimport { useHttpClient } from \"../../shared/hooks/http-hook\";\r\nimport ErrorModal from \"../../shared/components/UIElements/ErrorModal\";\r\nimport Card from '../../shared/components/UIElements/Card';\r\n\r\nconst Etudiant = () => {\r\n  const {error, sendRequest, clearError } = useHttpClient();\r\n  const [etudiant, setEtudiant] = useState();\r\n  const [ListeStages, setListeStages] = useState();\r\n  const [stageSelectionne, setstageSelectionne] = useState();\r\n  const numAdmission = useParams().numAdmission;\r\n  const history = useHistory();\r\n\r\n\r\n  useEffect(() => {\r\n    const recupererEtudiant = async () => {\r\n      try {\r\n        const responseData1 = await sendRequest(\r\n          process.env.REACT_APP_BACKEND_URL + `/etudiants/${numAdmission}`\r\n        );\r\n        setEtudiant(responseData1.etudiant);\r\n        console.log(responseData1.etudiant)\r\n        const responseData2 = await sendRequest(\r\n          process.env.REACT_APP_BACKEND_URL + `/stages/stages`\r\n        );\r\n        setListeStages(responseData2.stages);\r\n        console.log(responseData2.stages)\r\n\r\n        if (responseData2.stages.length > 0) {\r\n          setstageSelectionne(responseData2.stages[0].nomEntreprise);\r\n        }\r\n      } catch (err) {}\r\n    };\r\n    recupererEtudiant();\r\n  }, [sendRequest, numAdmission]);\r\n\r\n  const etudiantUpdateSubmitHandler = async event => {\r\n    event.preventDefault();\r\n    try {\r\n      console.log(stageSelectionne)\r\n      const monStage = ListeStages.find(stage => stage.nomEntreprise === stageSelectionne);\r\n      console.log(monStage)\r\n      await sendRequest(\r\n        process.env.REACT_APP_BACKEND_URL + `/etudiants/${numAdmission}`,\r\n        'PATCH',\r\n        JSON.stringify({\r\n          nom: etudiant.nom,\r\n          courriel: etudiant.courriel,\r\n          profil: etudiant.profil,\r\n          stage: monStage\r\n        }),\r\n        {\r\n          'Content-Type': 'application/json'\r\n        }\r\n      );\r\n      alert(\"Affectation réussie!\");\r\n      history.push('/etudiants');\r\n    } catch (err) {\r\n      alert(\"Erreur lors de l'affectation\");\r\n    }\r\n\r\n  };\r\n\r\n\r\n\r\n  if ((!ListeStages || !etudiant) && !error) {\r\n    return (\r\n      <div className=\"center\">\r\n        <Card>\r\n          <h2>Could not find place!</h2>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <ErrorModal error={error} onClear={clearError} />\r\n      <form onSubmit={etudiantUpdateSubmitHandler} className=\"formulaire\">\r\n        <h2>Affectation d'un stage pour l'étudiant #{etudiant.numAdmission}.</h2>\r\n        <label>Sélectionnez un stage<select\r\n          value={stageSelectionne}\r\n          onChange={(event) => {\r\n            setstageSelectionne(event.target.value);\r\n          }}\r\n          >\r\n          {ListeStages.map((stage, index) => \r\n          <option key={index}>{stage.nomEntreprise}</option>\r\n          )}\r\n          </select></label>\r\n          <button type=\"submit\">Affecter le stage à l'étudiant</button>\r\n      </form>\r\n    </React.Fragment>\r\n  );\r\n};\r\n\r\nexport default Etudiant;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}